import RPi.GPIO as GPIO
import time

class LED:
    def __init__(self, _pin):
        self.__pin = _pin
        self.__duty_cycle = 100
        self.__state = GPIO.LOW
        self.__last_blink = 0

        GPIO.setup(self.__pin, GPIO.OUT, initial=self.__state)
        GPIO.PWM(self.__pin, 5000)
        GPIO.start(self.__duty_cycle)

    def on(self):
        self.__state = GPIO.HIGH
        GPIO.output(self.__pin, self.__state)

    def off(self):
        self.__state = GPIO.LOW
        GPIO.output(self.pin, self.__state)

    # intensity: ranges from 0 to 100
    def adjust_intensity(self, intensity):
        self.__duty_cycle = intensity
        GPIO.ChangeDutyCycle(self.__duty_cycle)

    def blocking_blink(self, interval):
        self.on()
        time.sleep(interval/2)
        self.off()
        time.sleep(interval/2)

    def nonblocking_blink(self, interval):  
        if time.time() - self.__last_blink >= interval/2:
            if self.__state == GPIO.LOW:
                self.on()
            if self.__state == GPIO.HIGH:
                self.off()
            self.__last_blink = time.time()

